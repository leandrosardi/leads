<%

  # map some params who are specific for for the filter
  redirect_on_error = session['redirect_on_error']
  # setup default values
  redirect_on_error = "/leads/results" if redirect_on_error.to_s.size == 0
  redirect_on_success = "/leads/results" if redirect_on_success.to_s.size == 0


  begin
    puts params
    s = nil
    DB.transaction do
      # crear el cliente
      s = Leads::FlSearch.new({:saved => true, :id_user=>@login.user.id})
      s.save
    end # transaction
  rescue => e
    # libero recursos
    DB.disconnect
    GC.start
    # return errors
    redirect "#{redirect_on_error}?err="+ CGI::escape(e.message)

  end

  redirect redirect_on_success

%>